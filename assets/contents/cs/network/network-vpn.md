# 14. VPN (Virtual Private Network)

## π“ κ°λ…

```
κ³µμ© λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄ μ•μ „ν• μ‚¬μ„¤ λ„¤νΈμ›ν¬ μ—°κ²°μ„ μ κ³µ
- μ•”νΈν™”λ ν„°λ„
- μ•μ „ν• μ›κ²© μ ‘μ†
- μ§€λ¦¬μ  μ μ•½ μ°ν
```

### κΈ°λ³Έ μ›λ¦¬

```
VPN μ—†μ΄:
Client β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€> Server
     μΈν„°λ„· (ν‰λ¬Έ)
     λ„κµ¬λ‚ λ³Ό μ μμ β

VPN μ‚¬μ©:
Client β”€β”€[μ•”νΈν™” ν„°λ„]β”€β”€> VPN Server β”€β”€> Server
        λ„κµ¬λ„ λ³Ό μ μ—†μ β”
```

---

## π” VPN λ™μ‘ λ°©μ‹

### ν„°λ„λ§ (Tunneling)

```
1. μΊ΅μν™” (Encapsulation):
   μ›λ³Έ ν¨ν‚·μ„ μ•”νΈν™”ν•μ—¬ μƒ ν¨ν‚·μΌλ΅ κ°μ

   μ›λ³Έ: [IP Header | Data]
   β†“ μ•”νΈν™”
   VPN: [New IP | VPN Header | [Encrypted Original Packet]]

2. μ „μ†΅:
   μ•”νΈν™”λ ν¨ν‚·μ„ μΈν„°λ„·μΌλ΅ μ „μ†΅

3. μ—­μΊ΅μν™” (Decapsulation):
   VPN μ„λ²„κ°€ μ•”νΈν™” ν•΄μ 
   μ›λ³Έ ν¨ν‚· λ³µμ›
```

### μ—°κ²° κ³Όμ •

```
1. μΈμ¦ (Authentication):
   Client β†’ VPN Server
   μ‚¬μ©μλ…/λΉ„λ°€λ²νΈ, μΈμ¦μ„

2. ν‚¤ κµν™ (Key Exchange):
   μ•”νΈν™” ν‚¤ μƒμ„± λ° κµν™
   λ³΄μ• μ±„λ„ μλ¦½

3. ν„°λ„ μƒμ„± (Tunnel Establishment):
   μ•”νΈν™”λ ν„°λ„ μƒμ„±
   κ°€μƒ IP ν• λ‹Ή

4. λ°μ΄ν„° μ „μ†΅:
   λ¨λ“  νΈλν”½μ΄ ν„°λ„μ„ ν†µν•΄ μ „μ†΅
   μ•”νΈν™”/λ³µνΈν™” μλ™

5. μΆ…λ£:
   μ„Έμ… μΆ…λ£
   ν„°λ„ λ‹«ν
```

---

## π”§ VPN ν”„λ΅ν† μ½

### 1. PPTP (Point-to-Point Tunneling Protocol)

```
κ°€μ¥ μ¤λλ VPN ν”„λ΅ν† μ½

νΉμ§•:
- ν¬νΈ: TCP 1723
- μ•”νΈν™”: MPPE (μ•½ν•¨)
- λΉ λ¥Έ μ†λ„
- μ„¤μ • κ°„λ‹¨

μ¥μ :
β” λΉ λ¦„
β” λ„λ¦¬ μ§€μ›
β” κ°„λ‹¨ν• μ„¤μ •

λ‹¨μ :
β μ•½ν• λ³΄μ• (μ·¨μ•½μ  λ§μ)
β λ°©ν™”λ²½ μ°¨λ‹¨ μ‰¬μ›€

κ¶μ¥: μ‚¬μ© μ• ν•¨ β
```

### 2. L2TP/IPsec

```
L2TP (Layer 2 Tunneling Protocol)
+ IPsec (Internet Protocol Security)

νΉμ§•:
- ν¬νΈ: UDP 500, 1701, 4500
- μ•”νΈν™”: IPsec (AES)
- μ΄μ¤‘ μΊ΅μν™” (λλ¦Ό)

μ¥μ :
β” κ°•λ ¥ν• μ•”νΈν™”
β” λ„λ¦¬ μ§€μ›
β” μ•μ •μ 

λ‹¨μ :
β λλ¦° μ†λ„ (μ΄μ¤‘ μΊ΅μν™”)
β λ°©ν™”λ²½ ν†µκ³Ό μ–΄λ ¤μ›€

μ‚¬μ©:
- κΈ°μ—… VPN
```

### 3. OpenVPN β­

```
μ¤ν”μ†μ¤ VPN ν”„λ΅ν† μ½

νΉμ§•:
- ν¬νΈ: UDP 1194 λλ” TCP 443
- μ•”νΈν™”: OpenSSL (AES-256)
- λ§¤μ° μ•μ „
- μ μ—°ν• μ„¤μ •

μ¥μ :
β” κ°•λ ¥ν• λ³΄μ•
β” μ¤ν”μ†μ¤
β” λ°©ν™”λ²½ μ°ν μ‰¬μ›€
β” ν¬λ΅μ¤ ν”λ«νΌ

λ‹¨μ :
β ν΄λΌμ΄μ–ΈνΈ μ†ν”„νΈμ›¨μ–΄ ν•„μ”
β μ„¤μ • λ³µμ΅

μ‚¬μ©:
- κ°μΈ VPN (μ¶”μ²) β”
- κΈ°μ—… VPN
```

### 4. IKEv2/IPsec

```
Internet Key Exchange version 2

νΉμ§•:
- ν¬νΈ: UDP 500, 4500
- μ•”νΈν™”: IPsec (AES)
- λΉ λ¥Έ μ¬μ—°κ²°
- λ¨λ°”μΌ μΉν™”μ 

μ¥μ :
β” λΉ λ¥Έ μ†λ„
β” μ•μ •μ 
β” λ„¤νΈμ›ν¬ μ „ν™ μ‹ μλ™ μ¬μ—°κ²°
β” λ¨λ°”μΌ μµμ ν™”

λ‹¨μ :
β μ ν•μ  ν”λ«νΌ μ§€μ›
β λ°©ν™”λ²½ μ°¨λ‹¨ κ°€λ¥

μ‚¬μ©:
- λ¨λ°”μΌ VPN
- Windows, iOS κΈ°λ³Έ μ§€μ›
```

### 5. WireGuard β­β­

```
μµμ‹  VPN ν”„λ΅ν† μ½ (2020)

νΉμ§•:
- ν¬νΈ: UDP (μ»¤μ¤ν„°λ§μ΄μ§• κ°€λ¥)
- μ•”νΈν™”: ChaCha20, Poly1305
- λ§¤μ° λΉ λ¦„
- κ°„λ‹¨ν• μ½”λ“ (4,000μ¤„)

μ¥μ :
β” μµκ³ μ μ†λ„
β” κ°•λ ¥ν• λ³΄μ•
β” κ°„λ‹¨ν• μ„¤μ •
β” λ°°ν„°λ¦¬ ν¨μ¨μ 
β” ν„λ€μ  μ•”νΈν™”

λ‹¨μ :
β λΉ„κµμ  μƒλ΅μ›€
β μΌλ¶€ ν”λ«νΌ μ§€μ› λ¶€μ΅±

μ‚¬μ©:
- κ°μΈ VPN (μµμ‹  μ¶”μ²) β”
- μ°¨μ„Έλ€ ν‘μ¤€
```

---

## π VPN μ ν•

### 1. Site-to-Site VPN

```
λ‘ λ„¤νΈμ›ν¬λ¥Ό μ—°κ²°

λ³Έμ‚¬ β†[VPN ν„°λ„]β†’ μ§€μ‚¬

μ:
λ³Έμ‚¬ (μ„μΈ): 192.168.1.0/24
μ§€μ‚¬ (λ¶€μ‚°): 192.168.2.0/24

VPN μ—°κ²° ν›„:
λ³Έμ‚¬ μ§μ› β†’ μ§€μ‚¬ μ„λ²„ μ§μ ‘ μ ‘μ† κ°€λ¥

μ¥μ :
β” λ„¤νΈμ›ν¬ ν†µν•©
β” ν¬λ…ν• μ ‘μ†

μ‚¬μ©:
- κΈ°μ—… μ§€μ‚¬ μ—°κ²°
- λ°μ΄ν„°μ„Όν„° μ—°κ²°
```

### 2. Remote Access VPN (Client-to-Site)

```
κ°λ³„ ν΄λΌμ΄μ–ΈνΈκ°€ λ„¤νΈμ›ν¬μ— μ—°κ²°

μ¬νƒκ·Όλ¬΄μ β†[VPN]β†’ νμ‚¬ λ„¤νΈμ›ν¬

μ:
μ§‘ (κ³µμΈ IP: 203.0.113.5)
β†“ VPN μ—°κ²°
νμ‚¬ (κ°€μƒ IP: 192.168.1.100 ν• λ‹Ή)

μ ‘μ†:
- νμ‚¬ νμΌ μ„λ²„
- μ‚¬λ‚΄ μ‹μ¤ν…
- ν”„λ¦°ν„° λ“±

μ¥μ :
β” μ›κ²© κ·Όλ¬΄
β” μ•μ „ν• μ ‘μ†

μ‚¬μ©:
- μ¬νƒκ·Όλ¬΄
- μ¶μ¥
```

### 3. Personal VPN

```
κ°μΈ ν”„λΌμ΄λ²„μ‹ λ³΄νΈ

μ‚¬μ©μ β†[VPN]β†’ VPN μ κ³µμ β†β†’ μΈν„°λ„·

ν¨κ³Ό:
- IP μ£Όμ† μ¨κΉ€
- μ„μΉ λ³€κ²½
- νΈλν”½ μ•”νΈν™”

μ¥μ :
β” μµλ…μ„±
β” μ§€λ¦¬μ  μ μ•½ μ°ν
β” κ³µμ© WiFi λ³΄μ•

μ‚¬μ©:
- λ„·ν”λ¦­μ¤ μ§€μ—­ μ ν• μ°ν
- ν† λ νΈ
- κ³µμ© WiFi μ‚¬μ© μ‹
```

---

## π’» VPN μ„¤μ • μμ‹

### OpenVPN μ„λ²„ μ„¤μ • (Linux)

```bash
# OpenVPN μ„¤μΉ
apt-get install openvpn easy-rsa

# μΈμ¦μ„ μƒμ„±
make-cadir ~/openvpn-ca
cd ~/openvpn-ca
./easyrsa init-pki
./easyrsa build-ca
./easyrsa gen-req server nopass
./easyrsa sign-req server server
./easyrsa gen-dh
openvpn --genkey --secret ta.key

# μ„λ²„ μ„¤μ •
# /etc/openvpn/server.conf
port 1194
proto udp
dev tun

ca ca.crt
cert server.crt
key server.key
dh dh.pem
tls-auth ta.key 0

server 10.8.0.0 255.255.255.0
push "redirect-gateway def1 bypass-dhcp"
push "dhcp-option DNS 8.8.8.8"

keepalive 10 120
cipher AES-256-CBC
user nobody
group nogroup
persist-key
persist-tun

status openvpn-status.log
verb 3

# μ‹μ‘
systemctl start openvpn@server
```

### OpenVPN ν΄λΌμ΄μ–ΈνΈ μ„¤μ •

```
# client.ovpn
client
dev tun
proto udp
remote your-server-ip 1194

resolv-retry infinite
nobind
persist-key
persist-tun

ca ca.crt
cert client.crt
key client.key
tls-auth ta.key 1

cipher AES-256-CBC
verb 3
```

### WireGuard μ„¤μ •

```bash
# μ„λ²„ μ„¤μ •
# /etc/wireguard/wg0.conf
[Interface]
Address = 10.0.0.1/24
ListenPort = 51820
PrivateKey = SERVER_PRIVATE_KEY

[Peer]
PublicKey = CLIENT_PUBLIC_KEY
AllowedIPs = 10.0.0.2/32

# ν΄λΌμ΄μ–ΈνΈ μ„¤μ •
[Interface]
Address = 10.0.0.2/24
PrivateKey = CLIENT_PRIVATE_KEY
DNS = 8.8.8.8

[Peer]
PublicKey = SERVER_PUBLIC_KEY
Endpoint = your-server-ip:51820
AllowedIPs = 0.0.0.0/0
PersistentKeepalive = 25

# μ‹μ‘
wg-quick up wg0
```

---

## π” VPN λ³΄μ• λ° μ„±λ¥

### λ³΄μ• κ³ λ ¤μ‚¬ν•­

```
1. κ°•λ ¥ν• μ•”νΈν™”:
   - AES-256
   - ChaCha20

2. μΈμ¦:
   - μ‚¬μ©μλ…/λΉ„λ°€λ²νΈ
   - μΈμ¦μ„ (κ¶μ¥)
   - 2λ‹¨κ³„ μΈμ¦

3. ν‚¬ μ¤μ„μΉ (Kill Switch):
   - VPN μ—°κ²° λκΈ°λ©΄ μΈν„°λ„· μ°¨λ‹¨
   - λ°μ΄ν„° μ μ¶ λ°©μ§€

4. DNS λ„μ λ°©μ§€:
   - VPN DNS μ‚¬μ© κ°•μ 
   - μ‹¤μ  IP λ…Έμ¶ λ°©μ§€

5. λ΅κ·Έ μ •μ±…:
   - No-log μ •μ±…
   - ν”„λΌμ΄λ²„μ‹ λ³΄νΈ
```

### μ„±λ¥ μµμ ν™”

```
1. ν”„λ΅ν† μ½ μ„ νƒ:
   μ†λ„: WireGuard > IKEv2 > OpenVPN (UDP) > OpenVPN (TCP)
   λ³΄μ•: λ¨λ‘ μ•μ „ (μµμ‹  ν”„λ΅ν† μ½)

2. μ„λ²„ μ„μΉ:
   - κ°€κΉμ΄ μ„λ²„ μ„ νƒ
   - μ§€μ—°μ‹κ°„ κ°μ†

3. μ•”νΈν™” μμ¤€:
   - AES-128 vs AES-256
   - μ„±λ¥ vs λ³΄μ• κ· ν•

4. ν”„λ΅ν† μ½:
   - UDP: λΉ λ¦„ (μ†μ‹¤ ν—μ©)
   - TCP: λλ¦Ό (μ‹ λΆ°μ„±)

5. ν•λ“μ›¨μ–΄:
   - AES-NI μ§€μ› CPU
   - ν•λ“μ›¨μ–΄ κ°€μ†
```

---

## π μƒμ© VPN μ„λΉ„μ¤

### μ£Όμ” μ κ³µμ

```
1. ExpressVPN:
   - 94κ°κµ­, 3000+ μ„λ²„
   - λΉ λ¥Έ μ†λ„
   - No-log μ •μ±…

2. NordVPN:
   - 60κ°κµ­, 5400+ μ„λ²„
   - μ €λ ΄ν• κ°€κ²©
   - Double VPN

3. Surfshark:
   - λ¬΄μ ν• λ™μ‹ μ ‘μ†
   - μ €λ ΄
   - λΉ λ¥Έ μ†λ„

4. ProtonVPN:
   - λ¬΄λ£ ν”λ
   - μ¤μ„μ¤ (κ°•λ ¥ν• ν”„λΌμ΄λ²„μ‹ λ²•)
   - μ¤ν”μ†μ¤

5. Mullvad:
   - μµλ… κ³„μ • (μ΄λ©”μΌ λ¶ν•„μ”)
   - WireGuard μ§€μ›
   - ν”„λΌμ΄λ²„μ‹ μ¤‘μ‹¬
```

---

## π’¬ λ©΄μ ‘ λ‹µλ³€ μμ‹

### μ§§μ€ λ‹µλ³€
```
VPNμ€ κ³µμ© λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄
μ•μ „ν• μ‚¬μ„¤ λ„¤νΈμ›ν¬ μ—°κ²°μ„ μ κ³µν•©λ‹λ‹¤.

λ™μ‘:
1. μ•”νΈν™”λ ν„°λ„ μƒμ„±
2. λ¨λ“  νΈλν”½ μ•”νΈν™”
3. VPN μ„λ²„ κ²½μ 
4. λ©μ μ§€ λ„λ‹¬

μ¥μ :
- λ³΄μ• (μ•”νΈν™”)
- μµλ…μ„± (IP μ¨κΉ€)
- μ›κ²© μ ‘μ†

ν”„λ΅ν† μ½:
- OpenVPN (μ•μ „)
- WireGuard (λΉ λ¦„)
- IKEv2 (λ¨λ°”μΌ)
```

### μƒμ„Έ λ‹µλ³€
```
VPN (Virtual Private Network):

μ •μ:
κ³µμ© λ„¤νΈμ›ν¬(μΈν„°λ„·)λ¥Ό ν†µν•΄ 
μ•μ „ν• μ‚¬μ„¤ λ„¤νΈμ›ν¬ μ—°κ²°μ„ μƒμ„±ν•λ” κΈ°μ 

ν•µμ‹¬ κ°λ…:

1. ν„°λ„λ§ (Tunneling):
   - μ›λ³Έ ν¨ν‚· μ•”νΈν™”
   - μƒ ν¨ν‚·μΌλ΅ μΊ΅μν™”
   - μ•μ „ν• ν„°λ„ ν†µκ³Ό

2. μ•”νΈν™” (Encryption):
   - AES-256, ChaCha20
   - λ°μ΄ν„° λ³΄νΈ
   - λ„μ²­ λ°©μ§€

3. μΈμ¦ (Authentication):
   - μ‚¬μ©μ ν™•μΈ
   - μΈμ¦μ„ κΈ°λ°
   - μ•μ „ν• μ ‘μ†

λ™μ‘ κ³Όμ •:

1. μ—°κ²° μ”μ²­:
   Client β†’ VPN Server
   μΈμ¦ μ •λ³΄ μ „μ†΅

2. μΈμ¦ λ° ν‚¤ κµν™:
   - μ‚¬μ©μ μΈμ¦
   - μ•”νΈν™” ν‚¤ μƒμ„±
   - λ³΄μ• μ±„λ„ μλ¦½

3. ν„°λ„ μƒμ„±:
   - κ°€μƒ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤
   - κ°€μƒ IP ν• λ‹Ή
   - λΌμ°ν… μ„¤μ •

4. λ°μ΄ν„° μ „μ†΅:
   - λ¨λ“  νΈλν”½ μ•”νΈν™”
   - VPN μ„λ²„ κ²½μ 
   - λ©μ μ§€ μ „λ‹¬

VPN ν”„λ΅ν† μ½:

1. PPTP:
   - μ¤λλ¨
   - μ•½ν• λ³΄μ•
   - μ‚¬μ© κ¶μ¥ μ• ν•¨ β

2. L2TP/IPsec:
   - κ°•λ ¥ν• μ•”νΈν™”
   - λλ¦° μ†λ„
   - κΈ°μ—…μ—μ„ μ‚¬μ©

3. OpenVPN:
   - μ¤ν”μ†μ¤
   - λ§¤μ° μ•μ „
   - μ μ—°ν• μ„¤μ •
   - λ„λ¦¬ μ‚¬μ© β”

4. IKEv2/IPsec:
   - λΉ λ¥Έ μ†λ„
   - λ¨λ°”μΌ μµμ ν™”
   - μλ™ μ¬μ—°κ²°

5. WireGuard:
   - μµμ‹  (2020)
   - μµκ³ μ μ†λ„
   - κ°„λ‹¨ν• μ„¤μ •
   - μ°¨μ„Έλ€ ν‘μ¤€ β”

VPN μ ν•:

1. Site-to-Site:
   - λ„¤νΈμ›ν¬ κ°„ μ—°κ²°
   - λ³Έμ‚¬-μ§€μ‚¬ μ—°κ²°
   - ν¬λ…ν• μ ‘μ†

2. Remote Access:
   - κ°μΈ-λ„¤νΈμ›ν¬ μ—°κ²°
   - μ¬νƒκ·Όλ¬΄
   - μ›κ²© μ ‘μ†

3. Personal VPN:
   - ν”„λΌμ΄λ²„μ‹ λ³΄νΈ
   - IP μ£Όμ† μ¨κΉ€
   - μ§€μ—­ μ ν• μ°ν

μ¥μ :

β” λ³΄μ•:
   - μ•”νΈν™”λ ν†µμ‹ 
   - κ³µμ© WiFi μ•μ „

β” ν”„λΌμ΄λ²„μ‹:
   - IP μ£Όμ† μ¨κΉ€
   - μµλ… λΈλΌμ°μ§•

β” μ›κ²© μ ‘μ†:
   - μ¬νƒκ·Όλ¬΄
   - μ‚¬λ‚΄ μ‹μ¤ν… μ ‘μ†

β” μ§€μ—­ μ ν• μ°ν:
   - μ½ν…μΈ  μ ‘κ·Ό
   - κ²€μ—΄ μ°ν

λ‹¨μ :

β μ†λ„ μ €ν•:
   - μ•”νΈν™” μ¤λ²„ν—¤λ“
   - κ²½μ  μ„λ²„ μ§€μ—°

β λΉ„μ©:
   - μƒμ© VPN κµ¬λ…λ£
   - μ„λ²„ μ΄μ λΉ„μ©

β μ‹ λΆ° λ¬Έμ :
   - VPN μ κ³µμ μ‹ λΆ° ν•„μ”
   - No-log μ •μ±… ν™•μΈ

λ³΄μ• κ³ λ ¤μ‚¬ν•­:

1. ν‚¬ μ¤μ„μΉ:
   - VPN λκΈ°λ©΄ μΈν„°λ„· μ°¨λ‹¨
   - λ°μ΄ν„° μ μ¶ λ°©μ§€

2. DNS λ„μ λ°©μ§€:
   - VPN DNS μ‚¬μ©
   - μ‹¤μ  IP λ…Έμ¶ λ°©μ§€

3. κ°•λ ¥ν• μ•”νΈν™”:
   - AES-256
   - μµμ‹  ν”„λ΅ν† μ½

4. μΈμ¦:
   - μΈμ¦μ„ κΈ°λ°
   - 2λ‹¨κ³„ μΈμ¦

μ‹¤λ¬΄ ν™μ©:

κΈ°μ—…:
- μ¬νƒκ·Όλ¬΄ μ§€μ›
- μ§€μ‚¬ κ°„ μ—°κ²°
- λ³΄μ• ν†µμ‹ 

κ°μΈ:
- κ³µμ© WiFi λ³΄μ•
- ν”„λΌμ΄λ²„μ‹ λ³΄νΈ
- μ¤νΈλ¦¬λ° μ§€μ—­ μ ν• μ°ν

ν΄λΌμ°λ“:
- AWS VPN
- Azure VPN Gateway
- GCP Cloud VPN
```